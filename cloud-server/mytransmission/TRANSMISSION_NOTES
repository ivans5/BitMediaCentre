NOTE: this is needed (along with reload):
   firewall-cmd --zone=public --add-port=51413/udp --permanent


NOTE: irewall-cmd --zone=public --add-port=9091/tcp --permanent  ,
  along with a --reload is needed

Then,

curl _gateway:9091
#where _gateway is that POD's NIC with a .1 instead of the last number...

Then,

In /home/pcuser/.config/transmission-daemon/settings.json:
change to: 
    "rpc-whitelist-enabled": false,
    "rpc-bind-address": "10.42.25.1",   #<-- this is the IP address of the cni0 interface on the node 
#(AND/OR MAYBE THE "rpc-host"* options?...)
#NOTE:! settings.json keeps being overwritten!!  Google it!

Then, From the pod, commands such as:

sh-5.0$ transmission-remote _gateway -a "magnet:?xt=urn:btih:944cc141baf25155bfb110273140f1e0e6687f4b&dn=archlinux-2021.01.01-x86_64.iso"
_gateway:9091/transmission/rpc/ responded: "success"

or list,remove commands,etc.


New systemd service unit:


[Unit]
Description=Transmission BitTorrent Daemon
After=k3s-agent.service

[Service]
User=pcuser
Type=notify
#TODO: get this working:
#ExecStartPre=/bin/python3 -c 'import netifaces as n;open("/home/pcuser/someenvfile","w").write("CNI0_NODE_IP="+".".join(n.ifaddresses("flannel.1")[2][0]["addr"].split(".")[:3]+["1"]))'
ExecStart=/usr/bin/transmission-daemon -f --log-error --download-dir /home/pcuser --config-dir /home/pcuser/.config/transmission-daemon -T --rpc-bind-address ${CNI0_NODE_IP}
ExecReload=/bin/kill -s HUP $MAINPID
NoNewPrivileges=true
#EnvironmentFile=/home/pcuser/someenvfile
Environment=CNI0_NODE_IP=10.42.25.1

[Install]
WantedBy=multi-user.target


---










-
